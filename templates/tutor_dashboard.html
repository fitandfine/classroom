{% extends "base.html" %}
{% block title %}Tutor Dashboard{% endblock %}
{% block content %}
<h2 class="text-xl font-bold mb-4">Tutor Dashboard â€“ {{ current_user.name }}</h2>

<div class="grid md:grid-cols-2 gap-4">
  {% for entry in class_data %}
  <div class="bg-white p-4 rounded shadow">
    <h3 class="font-semibold text-lg">{{ entry.class.title }}</h3>
    <p class="text-sm text-slate-600 mb-2">{{ entry.class.description }}</p>
    <div class="text-sm mb-2">Students: {{ entry.students|length }}</div>

    <div class="flex gap-2 mb-4">
      <a href="{{ url_for('tutor_upload_quiz', class_id=entry.class.id) }}" class="px-3 py-1 bg-sky-600 text-white rounded">Create Quiz</a>
      <a href="{{ url_for('tutor_attendance', class_id=entry.class.id) }}" class="px-3 py-1 bg-amber-500 text-white rounded">Mark Attendance</a>
      <a href="{{ url_for('export_attendance', class_id=entry.class.id) }}" class="px-3 py-1 bg-slate-100 rounded">Export Attendance</a>
    </div>

    <h4 class="font-medium">Attendance Summary</h4>
    <ul class="mb-4 text-sm">
      {% for day in entry.attendance %}
      <li>{{ day.date }}: P={{ day.present }}, A={{ day.absent }}, J={{ day.justified }}</li>
      {% else %}
      <li class="text-slate-500">No attendance recorded.</li>
      {% endfor %}
    </ul>

    <h4 class="font-medium">Quizzes</h4>
    <ul class="space-y-1 text-sm">
      {% for stats in entry.quizzes %}
      <li class="flex justify-between items-center border rounded p-2">
        <div>
          <strong>{{ stats.quiz.title }}</strong>
          <div class="text-xs text-slate-500">{{ stats.quiz.description or '' }}</div>
        </div>
        <div class="flex gap-2 items-center">
          <div class="text-xs">Avg: {{ stats.avg_score }}%</div>
          <a href="{{ url_for('edit_quiz', quiz_id=stats.quiz.id) }}" class="px-2 py-1 bg-slate-100 rounded">Edit</a>
          <a href="{{ url_for('export_quiz_csv', quiz_id=stats.quiz.id) }}" class="px-2 py-1 bg-slate-100 rounded">CSV</a>
        </div>
      </li>
      {% else %}
      <li class="text-slate-500">No quizzes yet.</li>
      {% endfor %}
    </ul>
  </div>
  {% else %}
  <p class="text-slate-500">No classes yet. Create one to get started.</p>
  {% endfor %}
</div>
{% endblock %}
