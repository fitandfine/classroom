{% extends "base.html" %}
{% block title %}Student Dashboard{% endblock %}

{% block content %}
<h2 class="text-2xl font-bold mb-6">Welcome, {{ current_user.name }}</h2>

<!-- Classes -->
<section class="mb-8">
  <h3 class="text-lg font-semibold mb-3">Your Classes</h3>
  {% if classes %}
  <div class="grid md:grid-cols-2 gap-4">
    {% for c in classes %}
    <div class="bg-white rounded-lg shadow p-4 hover:shadow-lg transition">
      <h4 class="font-medium text-lg">{{ c.title }}</h4>
      <p class="text-sm text-slate-500 mb-2">{{ c.description or 'No description' }}</p>
      <p class="text-xs text-gray-600">Tutor: {{ c.tutor_name }} ({{ c.tutor_email }})</p>
    </div>
    {% endfor %}
  </div>
  {% else %}
  <p class="text-slate-500">You are not enrolled in any classes.</p>
  {% endif %}
</section>

<!-- Attendance -->
<section class="mb-8">
  <h3 class="text-lg font-semibold mb-3">Attendance Record</h3>
  {% if attendance %}
  <div class="overflow-x-auto">
    <table class="min-w-full bg-white rounded shadow">
      <thead class="bg-gray-50 border-b">
        <tr>
          <th class="py-2 px-4 text-left">Date</th>
          <th class="py-2 px-4 text-left">Class</th>
          <th class="py-2 px-4 text-left">Status</th>
          <th class="py-2 px-4 text-left">Reason</th>
        </tr>
      </thead>
      <tbody>
        {% for a in attendance %}
        <tr class="border-b hover:bg-gray-50 transition">
          <td class="py-2 px-4">{{ a.marked_at or '-' }}</td>
          <td class="py-2 px-4">{{ a.class_title }}</td>
          <td class="py-2 px-4">
            {% if a.status == 'present' %}
              <span class="px-2 py-1 rounded text-white bg-green-600 text-xs">Present</span>
            {% elif a.status == 'absent' %}
              <span class="px-2 py-1 rounded text-white bg-red-600 text-xs">Absent</span>
            {% elif a.status == 'justified' %}
              <span class="px-2 py-1 rounded text-white bg-yellow-500 text-xs">Justified</span>
            {% else %}
              <span class="text-gray-500 text-xs">-</span>
            {% endif %}
          </td>
          <td class="py-2 px-4">{{ a.reason or '-' }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  {% else %}
  <p class="text-slate-500">No attendance records yet.</p>
  {% endif %}
</section>

<!-- Quizzes -->
<section>
  <h3 class="text-lg font-semibold mb-3">Available Quizzes</h3>
  {% if quizzes %}
  <div class="grid md:grid-cols-2 gap-4">
    {% for q in quizzes %}
    <div class="bg-white rounded-lg shadow p-4 flex justify-between items-center hover:shadow-lg transition">
      <div>
        <h4 class="font-medium">{{ q.title }}</h4>
        <p class="text-xs text-slate-500 mb-1">{{ q.class_title }}</p>
        {% if q.score is not none %}
          <span class="px-2 py-1 bg-green-600 text-white text-xs rounded">Completed {{ q.score }}%</span>
        {% else %}
          <span class="px-2 py-1 bg-gray-200 text-gray-700 text-xs rounded">Not Taken</span>
        {% endif %}
      </div>
      <div class="flex gap-2">
        {% if q.score is none %}
        <a href="{{ url_for('take_quiz', quiz_id=q.id) }}" class="px-3 py-1 bg-sky-600 text-white rounded hover:bg-sky-700 transition">Take Quiz</a>
        {% else %}
        <a href="{{ url_for('quiz_results', quiz_id=q.id) }}" class="px-3 py-1 bg-slate-100 text-gray-700 rounded hover:bg-slate-200 transition">View Results</a>
        {% endif %}
      </div>
    </div>
    {% endfor %}
  </div>
  {% else %}
  <p class="text-slate-500">No quizzes available.</p>
  {% endif %}
</section>
{% endblock %}
