{% extends "base.html" %}
{% block title %}Student Dashboard{% endblock %}
{% block content %}
<h2 class="text-xl font-bold mb-4">Welcome, {{ current_user.name }}</h2>

<h3 class="text-lg font-semibold mb-2">Your Classes</h3>
<ul class="mb-6">
  {% for c in classes %}
    <li class="mb-2 border p-2 rounded">
      <div class="font-medium">{{ c.title }}</div>
      <div class="text-sm text-slate-600">Tutor: {{ c.tutor_name }} ({{ c.tutor_email }})</div>
      <div class="text-sm">{{ c.description }}</div>
    </li>
  {% else %}
    <li class="text-slate-500">You are not enrolled in any classes.</li>
  {% endfor %}
</ul>

<h3 class="text-lg font-semibold mb-2">Attendance Record</h3>
<table class="min-w-full bg-white rounded shadow mb-6">
  <thead>
    <tr><th class="py-2 px-4">Date</th><th class="py-2 px-4">Class</th><th class="py-2 px-4">Status</th><th class="py-2 px-4">Reason</th></tr>
  </thead>
  <tbody>
    {% for a in attendance %}
    <tr class="border-b">
      <td class="py-2 px-4">{{ a.date }}</td>
      <td class="py-2 px-4">{{ a.class_title }}</td>
      <td class="py-2 px-4 capitalize">{{ a.status }}</td>
      <td class="py-2 px-4">{{ a.reason or '-' }}</td>
    </tr>
    {% else %}
    <tr><td colspan="4" class="py-2 px-4 text-slate-500">No attendance records yet.</td></tr>
    {% endfor %}
  </tbody>
</table>

<h3 class="text-lg font-semibold mb-2">Available Quizzes</h3>
<table class="min-w-full bg-white rounded shadow">
  <thead>
    <tr><th class="py-2 px-4">Quiz</th><th class="py-2 px-4">Class</th><th class="py-2 px-4">Status</th><th class="py-2 px-4">Action</th></tr>
  </thead>
  <tbody>
    {% for q in quizzes %}
    <tr class="border-b">
      <td class="py-2 px-4">{{ q.title }}</td>
      <td class="py-2 px-4">{{ q.class_title }}</td>
      <td class="py-2 px-4">
        {% if q.score is not none %}Completed ({{ q.score }}%){% else %}Not Taken{% endif %}
      </td>
      <td class="py-2 px-4">
        {% if q.score is none %}
        <a href="{{ url_for('take_quiz', quiz_id=q.id) }}" class="px-3 py-1 bg-sky-600 text-white rounded">Take Quiz</a>
        {% else %}
        <a href="{{ url_for('quiz_results', quiz_id=q.id) }}" class="px-3 py-1 bg-slate-100 rounded">View Results</a>
        {% endif %}
      </td>
    </tr>
    {% else %}
    <tr><td colspan="4" class="py-2 px-4 text-slate-500">No quizzes available.</td></tr>
    {% endfor %}
  </tbody>
</table>

{% endblock %}
